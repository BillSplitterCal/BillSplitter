<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2575.5">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; min-height: 14.0px}
  </style>
</head>
<body>
<p class="p1">&lt;!DOCTYPE html&gt;</p>
<p class="p1">&lt;html lang="en"&gt;</p>
<p class="p1">&lt;head&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;meta charset="UTF-8"&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;title&gt;Bill Splitter Calculator&lt;/title&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;!-- Tailwind CSS CDN --&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;script src="https://cdn.tailwindcss.com"&gt;&lt;/script&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;!-- Link to Web App Manifest --&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;link rel="manifest" href="manifest.json"&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;style&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>/* Custom font for Inter */</p>
<p class="p1"><span class="Apple-converted-space">        </span>@import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&amp;display=swap');</p>
<p class="p1"><span class="Apple-converted-space">        </span>body {</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-family: 'Inter', sans-serif;</p>
<p class="p1"><span class="Apple-converted-space">            </span>background-color: #f0f4f8; /* Light blue-gray background */</p>
<p class="p1"><span class="Apple-converted-space">            </span>display: flex;</p>
<p class="p1"><span class="Apple-converted-space">            </span>justify-content: center;</p>
<p class="p1"><span class="Apple-converted-space">            </span>align-items: center;</p>
<p class="p1"><span class="Apple-converted-space">            </span>min-height: 100vh;</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin: 0;</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding: 20px; /* Add some padding for smaller screens */</p>
<p class="p1"><span class="Apple-converted-space">            </span>box-sizing: border-box; /* Ensure padding is included in total width/height */</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>.calculator-container {</p>
<p class="p1"><span class="Apple-converted-space">            </span>background-color: #ffffff;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-radius: 1.5rem; /* More rounded corners */</p>
<p class="p1"><span class="Apple-converted-space">            </span>box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 8px 10px -6px rgba(0, 0, 0, 0.05); /* Softer shadow */</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding: 2.5rem; /* Increased padding */</p>
<p class="p1"><span class="Apple-converted-space">            </span>max-width: 450px; /* Slightly wider */</p>
<p class="p1"><span class="Apple-converted-space">            </span>width: 100%;</p>
<p class="p1"><span class="Apple-converted-space">            </span>display: flex;</p>
<p class="p1"><span class="Apple-converted-space">            </span>flex-direction: column;</p>
<p class="p1"><span class="Apple-converted-space">            </span>gap: 1.5rem; /* Space between sections */</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>.input-group label {</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-weight: 600; /* Semi-bold label */</p>
<p class="p1"><span class="Apple-converted-space">            </span>color: #374151; /* Darker gray for labels */</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin-bottom: 0.5rem;</p>
<p class="p1"><span class="Apple-converted-space">            </span>display: block;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>.input-group input[type="number"],</p>
<p class="p1"><span class="Apple-converted-space">        </span>.input-group select { /* Apply similar styles to select for consistency */</p>
<p class="p1"><span class="Apple-converted-space">            </span>width: 100%;</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding: 0.75rem 1rem; /* Comfortable padding */</p>
<p class="p1"><span class="Apple-converted-space">            </span>border: 2px solid #d1d5db; /* Light gray border */</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-radius: 0.75rem; /* Rounded input fields */</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-size: 1rem;</p>
<p class="p1"><span class="Apple-converted-space">            </span>color: #1f2937; /* Dark text */</p>
<p class="p1"><span class="Apple-converted-space">            </span>transition: border-color 0.2s ease-in-out, box-shadow 0.2s ease-in-out;</p>
<p class="p1"><span class="Apple-converted-space">            </span>outline: none;</p>
<p class="p1"><span class="Apple-converted-space">            </span>-webkit-appearance: none; /* Remove default select styling for custom arrow */</p>
<p class="p1"><span class="Apple-converted-space">            </span>-moz-appearance: none;</p>
<p class="p1"><span class="Apple-converted-space">            </span>appearance: none;</p>
<p class="p1"><span class="Apple-converted-space">            </span>background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 20 20' fill='currentColor'%3E%3Cpath fill-rule='evenodd' d='M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z' clip-rule='evenodd' /%3E%3C/svg%3E");</p>
<p class="p1"><span class="Apple-converted-space">            </span>background-repeat: no-repeat;</p>
<p class="p1"><span class="Apple-converted-space">            </span>background-position: right 0.75rem center;</p>
<p class="p1"><span class="Apple-converted-space">            </span>background-size: 1.5em 1.5em;</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding-right: 2.5rem; /* Make space for the arrow */</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>.input-group input[type="number"]:focus,</p>
<p class="p1"><span class="Apple-converted-space">        </span>.input-group select:focus {</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-color: #6366f1; /* Indigo on focus */</p>
<p class="p1"><span class="Apple-converted-space">            </span>box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.2); /* Soft focus ring */</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>.result-display {</p>
<p class="p1"><span class="Apple-converted-space">            </span>background-color: #e0e7ff; /* Light indigo background for results */</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-radius: 1rem; /* Rounded corners for result box */</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding: 1.5rem;</p>
<p class="p1"><span class="Apple-converted-space">            </span>text-align: center;</p>
<p class="p1"><span class="Apple-converted-space">            </span>display: flex;</p>
<p class="p1"><span class="Apple-converted-space">            </span>flex-direction: column;</p>
<p class="p1"><span class="Apple-converted-space">            </span>gap: 0.75rem; /* Space between result lines */</p>
<p class="p1"><span class="Apple-converted-space">            </span>border: 1px solid #c7d2fe; /* Subtle border */</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>.result-display p {</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-size: 1rem;</p>
<p class="p1"><span class="Apple-converted-space">            </span>color: #4b5563; /* Medium gray text */</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>.result-display .amount {</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-size: 1.75rem; /* Larger amount */</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-weight: 700; /* Bold amount */</p>
<p class="p1"><span class="Apple-converted-space">            </span>color: #4f46e5; /* Deeper indigo for amounts */</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>.calculate-button, .insights-button {</p>
<p class="p1"><span class="Apple-converted-space">            </span>background-color: #4f46e5; /* Deep indigo button */</p>
<p class="p1"><span class="Apple-converted-space">            </span>color: #ffffff;</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding: 0.85rem 1.5rem;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-radius: 0.75rem;</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-size: 1.1rem;</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-weight: 600;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border: none;</p>
<p class="p1"><span class="Apple-converted-space">            </span>cursor: pointer;</p>
<p class="p1"><span class="Apple-converted-space">            </span>transition: background-color 0.2s ease-in-out, transform 0.1s ease-in-out;</p>
<p class="p1"><span class="Apple-converted-space">            </span>width: 100%;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>.calculate-button:hover, .insights-button:hover {</p>
<p class="p1"><span class="Apple-converted-space">            </span>background-color: #4338ca; /* Slightly darker indigo on hover */</p>
<p class="p1"><span class="Apple-converted-space">            </span>transform: translateY(-2px); /* Slight lift effect */</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>.calculate-button:active, .insights-button:active {</p>
<p class="p1"><span class="Apple-converted-space">            </span>background-color: #3730a3; /* Even darker on active */</p>
<p class="p1"><span class="Apple-converted-space">            </span>transform: translateY(0);</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>/* Style for error message */</p>
<p class="p1"><span class="Apple-converted-space">        </span>#errorMessage {</p>
<p class="p1"><span class="Apple-converted-space">            </span>color: #dc2626; /* Red text for errors */</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-size: 0.9rem;</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin-top: 0.5rem;</p>
<p class="p1"><span class="Apple-converted-space">            </span>text-align: center;</p>
<p class="p1"><span class="Apple-converted-space">            </span>display: none; /* Hidden by default */</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>.insights-display {</p>
<p class="p1"><span class="Apple-converted-space">            </span>background-color: #f0f9ff; /* Very light blue background for insights */</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-radius: 1rem;</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding: 1.5rem;</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin-top: 1.5rem;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border: 1px solid #bae6fd; /* Light blue border */</p>
<p class="p1"><span class="Apple-converted-space">            </span>color: #0c4a6e; /* Darker blue text */</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-size: 0.95rem;</p>
<p class="p1"><span class="Apple-converted-space">            </span>line-height: 1.5;</p>
<p class="p1"><span class="Apple-converted-space">            </span>min-height: 50px; /* Minimum height to avoid collapse */</p>
<p class="p1"><span class="Apple-converted-space">            </span>display: flex;</p>
<p class="p1"><span class="Apple-converted-space">            </span>align-items: center;</p>
<p class="p1"><span class="Apple-converted-space">            </span>justify-content: center;</p>
<p class="p1"><span class="Apple-converted-space">            </span>text-align: center;</p>
<p class="p1"><span class="Apple-converted-space">            </span>word-wrap: break-word; /* Ensure text wraps */</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>.insights-display.loading::before {</p>
<p class="p1"><span class="Apple-converted-space">            </span>content: 'Generating insights...';</p>
<p class="p1"><span class="Apple-converted-space">            </span>color: #6b7280;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/style&gt;</p>
<p class="p1">&lt;/head&gt;</p>
<p class="p1">&lt;body&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;div class="calculator-container"&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;h1 class="text-3xl font-bold text-center text-gray-800 mb-6"&gt;Bill Splitter&lt;/h1&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div class="input-group"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;label for="billAmount"&gt;Bill Amount:&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;input type="number" id="billAmount" placeholder="e.g., 100" min="0" value="0"&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div class="input-group"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;label for="currencySelect"&gt;Currency:&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;select id="currencySelect"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;option value="USD"&gt;$ USD&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;option value="EUR"&gt;€ EUR&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;option value="GBP"&gt;£ GBP&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;option value="JPY"&gt;¥ JPY&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;option value="ZAR"&gt;R ZAR&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/select&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div class="input-group"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;label for="numPeople"&gt;Number of People:&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;input type="number" id="numPeople" placeholder="e.g., 2" min="1" value="1"&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div class="input-group"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;label for="tipPercentage"&gt;Tip Percentage (%):&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;input type="number" id="tipPercentage" placeholder="e.g., 15" min="0" value="15"&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;button id="calculateBtn" class="calculate-button"&gt;Calculate&lt;/button&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;p id="errorMessage" class="hidden"&gt;Please enter valid numbers for all fields.&lt;/p&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div class="result-display mt-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;p&gt;Tip Amount: &lt;span id="tipAmountDisplay" class="amount"&gt;$0.00&lt;/span&gt;&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;p&gt;Total Per Person: &lt;span id="totalPerPersonDisplay" class="amount"&gt;$0.00&lt;/span&gt;&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;button id="getInsightsBtn" class="insights-button mt-4"&gt;✨ Get Insights ✨&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div id="insightsDisplay" class="insights-display"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;!-- Insights generated by LLM will appear here --&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;script&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>// Get references to HTML elements</p>
<p class="p1"><span class="Apple-converted-space">        </span>const billAmountInput = document.getElementById('billAmount');</p>
<p class="p1"><span class="Apple-converted-space">        </span>const currencySelect = document.getElementById('currencySelect');</p>
<p class="p1"><span class="Apple-converted-space">        </span>const numPeopleInput = document.getElementById('numPeople');</p>
<p class="p1"><span class="Apple-converted-space">        </span>const tipPercentageInput = document.getElementById('tipPercentage');</p>
<p class="p1"><span class="Apple-converted-space">        </span>const calculateBtn = document.getElementById('calculateBtn');</p>
<p class="p1"><span class="Apple-converted-space">        </span>const getInsightsBtn = document.getElementById('getInsightsBtn');</p>
<p class="p1"><span class="Apple-converted-space">        </span>const tipAmountDisplay = document.getElementById('tipAmountDisplay');</p>
<p class="p1"><span class="Apple-converted-space">        </span>const totalPerPersonDisplay = document.getElementById('totalPerPersonDisplay');</p>
<p class="p1"><span class="Apple-converted-space">        </span>const errorMessage = document.getElementById('errorMessage');</p>
<p class="p1"><span class="Apple-converted-space">        </span>const insightsDisplay = document.getElementById('insightsDisplay');</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Currency symbols mapping</p>
<p class="p1"><span class="Apple-converted-space">        </span>const currencySymbols = {</p>
<p class="p1"><span class="Apple-converted-space">            </span>"USD": "$",</p>
<p class="p1"><span class="Apple-converted-space">            </span>"EUR": "€",</p>
<p class="p1"><span class="Apple-converted-space">            </span>"GBP": "£",</p>
<p class="p1"><span class="Apple-converted-space">            </span>"JPY": "¥",</p>
<p class="p1"><span class="Apple-converted-space">            </span>"ZAR": "R"</p>
<p class="p1"><span class="Apple-converted-space">        </span>};</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>/**</p>
<p class="p1"><span class="Apple-converted-space">         </span>* Formats a number as a currency string with the selected symbol.</p>
<p class="p1"><span class="Apple-converted-space">         </span>* @param {number} amount - The numeric amount to format.</p>
<p class="p1"><span class="Apple-converted-space">         </span>* @returns {string} The formatted currency string.</p>
<p class="p1"><span class="Apple-converted-space">         </span>*/</p>
<p class="p1"><span class="Apple-converted-space">        </span>function formatCurrency(amount) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const selectedCurrency = currencySelect.value;</p>
<p class="p1"><span class="Apple-converted-space">            </span>const symbol = currencySymbols[selectedCurrency] || "$"; // Default to $ if not found</p>
<p class="p1"><span class="Apple-converted-space">            </span>return `${symbol}${amount.toFixed(2)}`;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>/**</p>
<p class="p1"><span class="Apple-converted-space">         </span>* Calculates and displays the bill split.</p>
<p class="p1"><span class="Apple-converted-space">         </span>*/</p>
<p class="p1"><span class="Apple-converted-space">        </span>function calculateBill() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>// Get values from input fields and parse them as floats</p>
<p class="p1"><span class="Apple-converted-space">            </span>const billAmount = parseFloat(billAmountInput.value);</p>
<p class="p1"><span class="Apple-converted-space">            </span>const numPeople = parseInt(numPeopleInput.value, 10);</p>
<p class="p1"><span class="Apple-converted-space">            </span>const tipPercentage = parseFloat(tipPercentageInput.value);</p>
<p class="p1"><span class="Apple-converted-space">            </span>const selectedCurrency = currencySelect.value; // Get selected currency for display</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Validate inputs</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (isNaN(billAmount) || isNaN(numPeople) || isNaN(tipPercentage) || billAmount &lt; 0 || numPeople &lt;= 0 || tipPercentage &lt; 0) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>errorMessage.style.display = 'block'; // Show error message</p>
<p class="p1"><span class="Apple-converted-space">                </span>tipAmountDisplay.textContent = formatCurrency(0); // Show 0 with current currency</p>
<p class="p1"><span class="Apple-converted-space">                </span>totalPerPersonDisplay.textContent = formatCurrency(0); // Show 0 with current currency</p>
<p class="p1"><span class="Apple-converted-space">                </span>getInsightsBtn.disabled = true; // Disable insights button on invalid input</p>
<p class="p1"><span class="Apple-converted-space">                </span>insightsDisplay.textContent = ''; // Clear insights</p>
<p class="p1"><span class="Apple-converted-space">                </span>insightsDisplay.classList.remove('loading');</p>
<p class="p1"><span class="Apple-converted-space">                </span>return; // Stop execution if inputs are invalid</p>
<p class="p1"><span class="Apple-converted-space">            </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">                </span>errorMessage.style.display = 'none'; // Hide error message if inputs are valid</p>
<p class="p1"><span class="Apple-converted-space">                </span>getInsightsBtn.disabled = false; // Enable insights button</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Calculate tip amount</p>
<p class="p1"><span class="Apple-converted-space">            </span>const tipAmount = billAmount * (tipPercentage / 100);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Calculate total bill with tip</p>
<p class="p1"><span class="Apple-converted-space">            </span>const totalBillWithTip = billAmount + tipAmount;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Calculate amount per person</p>
<p class="p1"><span class="Apple-converted-space">            </span>const totalPerPerson = totalBillWithTip / numPeople;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Update the display with calculated values, formatted to two decimal places and with currency symbol</p>
<p class="p1"><span class="Apple-converted-space">            </span>tipAmountDisplay.textContent = formatCurrency(tipAmount);</p>
<p class="p1"><span class="Apple-converted-space">            </span>totalPerPersonDisplay.textContent = formatCurrency(totalPerPerson);</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>/**</p>
<p class="p1"><span class="Apple-converted-space">         </span>* Fetches insights from the Gemini API based on bill details.</p>
<p class="p1"><span class="Apple-converted-space">         </span>*/</p>
<p class="p1"><span class="Apple-converted-space">        </span>async function getBillInsights() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const billAmount = parseFloat(billAmountInput.value);</p>
<p class="p1"><span class="Apple-converted-space">            </span>const numPeople = parseInt(numPeopleInput.value, 10);</p>
<p class="p1"><span class="Apple-converted-space">            </span>const selectedCurrency = currencySelect.value;</p>
<p class="p1"><span class="Apple-converted-space">            </span>const currencySymbol = currencySymbols[selectedCurrency] || "$";</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Basic validation before calling LLM</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (isNaN(billAmount) || isNaN(numPeople) || billAmount &lt;= 0 || numPeople &lt;= 0) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>insightsDisplay.textContent = 'Please enter a valid bill amount and number of people to get insights.';</p>
<p class="p1"><span class="Apple-converted-space">                </span>insightsDisplay.classList.remove('loading');</p>
<p class="p1"><span class="Apple-converted-space">                </span>return;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>insightsDisplay.textContent = ''; // Clear previous insights</p>
<p class="p1"><span class="Apple-converted-space">            </span>insightsDisplay.classList.add('loading'); // Show loading state</p>
<p class="p1"><span class="Apple-converted-space">            </span>getInsightsBtn.disabled = true; // Disable button while loading</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>try {</p>
<p class="p1"><span class="Apple-converted-space">                </span>const prompt = `Given a total bill amount of ${currencySymbol}${billAmount.toFixed(2)} and ${numPeople} people splitting it, provide a concise summary of what this outing might have been like and a general tip suggestion based on these numbers, assuming standard service. Keep the response to 2-3 sentences.`;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                </span>let chatHistory = [];</p>
<p class="p1"><span class="Apple-converted-space">                </span>chatHistory.push({ role: "user", parts: [{ text: prompt }] });</p>
<p class="p1"><span class="Apple-converted-space">                </span>const payload = { contents: chatHistory };</p>
<p class="p1"><span class="Apple-converted-space">                </span>const apiKey = ""; // Canvas will provide this key at runtime</p>
<p class="p1"><span class="Apple-converted-space">                </span>const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                </span>const response = await fetch(apiUrl, {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>method: 'POST',</p>
<p class="p1"><span class="Apple-converted-space">                    </span>headers: { 'Content-Type': 'application/json' },</p>
<p class="p1"><span class="Apple-converted-space">                    </span>body: JSON.stringify(payload)</p>
<p class="p1"><span class="Apple-converted-space">                </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                </span>const result = await response.json();</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                </span>if (result.candidates &amp;&amp; result.candidates.length &gt; 0 &amp;&amp;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>result.candidates[0].content &amp;&amp; result.candidates[0].content.parts &amp;&amp;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>result.candidates[0].content.parts.length &gt; 0) {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>const text = result.candidates[0].content.parts[0].text;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>insightsDisplay.textContent = text;</p>
<p class="p1"><span class="Apple-converted-space">                </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>insightsDisplay.textContent = 'Could not generate insights. Please try again.';</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p1"><span class="Apple-converted-space">            </span>} catch (error) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>console.error('Error fetching insights:', error);</p>
<p class="p1"><span class="Apple-converted-space">                </span>insightsDisplay.textContent = 'Error generating insights. Please check your connection.';</p>
<p class="p1"><span class="Apple-converted-space">            </span>} finally {</p>
<p class="p1"><span class="Apple-converted-space">                </span>insightsDisplay.classList.remove('loading'); // Hide loading state</p>
<p class="p1"><span class="Apple-converted-space">                </span>getInsightsBtn.disabled = false; // Re-enable button</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Add event listener to the calculate button</p>
<p class="p1"><span class="Apple-converted-space">        </span>calculateBtn.addEventListener('click', calculateBill);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Add event listener to the get insights button</p>
<p class="p1"><span class="Apple-converted-space">        </span>getInsightsBtn.addEventListener('click', getBillInsights);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Add event listeners to input fields and currency select for real-time updates and to enable/disable insights button</p>
<p class="p1"><span class="Apple-converted-space">        </span>billAmountInput.addEventListener('input', calculateBill);</p>
<p class="p1"><span class="Apple-converted-space">        </span>currencySelect.addEventListener('change', calculateBill); // Listen for currency change</p>
<p class="p1"><span class="Apple-converted-space">        </span>numPeopleInput.addEventListener('input', calculateBill);</p>
<p class="p1"><span class="Apple-converted-space">        </span>tipPercentageInput.addEventListener('input', calculateBill);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Service Worker Registration</p>
<p class="p1"><span class="Apple-converted-space">        </span>if ('serviceWorker' in navigator) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>window.addEventListener('load', () =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                </span>// Register the service worker from the root scope to ensure correct path resolution</p>
<p class="p1"><span class="Apple-converted-space">                </span>navigator.serviceWorker.register('service-worker.js', { scope: '/' })</p>
<p class="p1"><span class="Apple-converted-space">                    </span>.then(registration =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>console.log('Service Worker registered with scope:', registration.scope);</p>
<p class="p1"><span class="Apple-converted-space">                    </span>})</p>
<p class="p1"><span class="Apple-converted-space">                    </span>.catch(error =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>console.error('Service Worker registration failed:', error);</p>
<p class="p1"><span class="Apple-converted-space">                    </span>});</p>
<p class="p1"><span class="Apple-converted-space">            </span>});</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Initial calculation and disable insights button when the page loads if inputs are invalid</p>
<p class="p1"><span class="Apple-converted-space">        </span>document.addEventListener('DOMContentLoaded', () =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">            </span>calculateBill(); // Perform initial calculation</p>
<p class="p1"><span class="Apple-converted-space">            </span>// If calculateBill finds invalid inputs on load, it will disable getInsightsBtn</p>
<p class="p1"><span class="Apple-converted-space">        </span>});</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/script&gt;</p>
<p class="p1">&lt;/body&gt;</p>
<p class="p1">&lt;/html&gt;</p>
</body>
</html>
